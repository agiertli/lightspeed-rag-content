FROM quay.io/$USERNAME/tool:latest as tool

USER 0
WORKDIR /workdir

RUN python3.11 generate_embeddings_tool.py -i /markdown -emd embeddings_model \
    -emn sentence-transformers/all-mpnet-base-v2 -o vector_db -id vector_db_index

FROM registry.access.redhat.com/ubi9/ubi-minimal:latest
COPY --from=tool /workdir/vector_db /rag/vector_db
